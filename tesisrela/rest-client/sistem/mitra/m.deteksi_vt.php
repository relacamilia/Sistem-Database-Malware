<?php

//------------------------------RESTFULL----------------------------------
require '../function/functions.php';
require '../function/functions_vt.php';
require '../api/api_recent.php';

$hash = $_GET['sha256'];
$file = $_GET['file'];
$name = $_GET['name'];
$idm = $_GET['idm'];

// cek didataset virustotal, ambil report
$js = virusTotal($hash);

  // jika belum ada report, kirim file untuk di scan dan tampilkan message
  if($js === 0){

    //simpan log ke db riwayat
    $isi = [
      'idm' => $idm,
      'file_mitra' => $name,
      'sha256_mitra' => $hash,
      'status' => "Queue",
      'aksi' => "Deteksi",
      'metode' => "Virus Total"
    ];
    createMRiwayat($isi);
    
      $result = scanVtMitra($idm, $file, $hash);

      

      //cek hasil apakah message atau hasil $js[array]
      if(is_array($result)){
      $js = $result;
      }
  }

// jika ada report
$data = $js['data']['attributes'];
$stats = $data['last_analysis_stats'];
$detec = $data['last_analysis_results'];
$exif = $data['exiftool'];


if(($stats['malicious']) == 0) {
  $result = "UNDETECTED";
  $img = "19.png";
  $color ="success";
  //simpan log ke db riwayat
  $isi = [
    'idm' => $idm,
    'file_mitra' => $name,
    'sha256_mitra' => $hash,
    'status' => "Undetected",
    'aksi' => "Deteksi",
    'metode' => "Virus Total"
  ];
  createMRiwayat($isi);

} else {
  $result = "DETECTED";
  $img = "21.png";
  $color ="danger";
  //simpan log ke db riwayat
  $isi = [
    'idm' => $idm,
    'file_mitra' => $name,
    'sha256_mitra' => $hash,
    'status' => "Detected",
    'aksi' => "Deteksi",
    'metode' => "Virus Total"
  ];
  createMRiwayat($isi);
} 

?>

<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="../../css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="../../fontawesome-web/css/all.min.css">
   <title>Sistem Database Malware</title>
  </head>

  <body class="mt-3">
    <!-- navbar -->
    <nav class="navbar fixed-top navbar-expand-lg navbar-light bg-info">
      <div class="container">
      <div class="navbar-brand text-light">
      <img src="../../img/1.png" width="30" height="30"> Sistem Database Malware</div>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
        <div class="navbar-nav font-weight-bold">
        <div class="row text-center ml-5">
          <a class="nav-item nav-link ml-5" href="m.akun.php?idm=<?=$idm;?>">PROFIL</a>
          <a class="nav-item nav-link" href="m.index.php?idm=<?=$idm;?>">MENU</a>
          <a class="nav-item nav-link active" href="m.deteksi.php?idm=<?=$idm;?>">DETEKSI<span class="sr-only">(current)</span></a>
          <a class="nav-item nav-link" href="m.lab.php?idm=<?=$idm;?>">LAB</a>
          <a class="nav-item nav-link" href="m.riwayat.php?idm=<?=$idm;?>">RIWAYAT</a>
        </div>
        </div>
        <div class="navbar-nav ml-auto">
          <a class="nav-item nav-link btn btn-sm btn-outline-dark font-weight-bold" data-toggle="modal" data-target="#logoutModal"><i class="fas fa-sign-out-alt pr-1"></i>Logout</a>
        </div>
      </div>
      </div>
    </nav>
    <!-- akhir navbar -->

    <!-- hasil analisa Virus Total -->
    <section>
    <div class="container"><br><br><br>
     
      <div class="row">
        <div class="col-4 offset-4 text-center">
          <img class="pt-2 pb-3" src="../../img/17.png" width="200">
        </div><br>
        <div class="col-4 pt-4 text-right">
          <a href="m.deteksi.php?idm=<?=$idm;?>" class="btn btn-secondary">Kembali</a>
        </div>
      </div>

      <div class="card">
        <div class="card-body">   
          <div class="card-header alert-<?=$color;?>" id="result">
            <h3 class="font-weight-bold text-center">RESULT</h3>
          </div>  

          <div class="row">
            <div class="col-4 text-center">
              <img src="../../img/<?= $img;?>" width="110" class="pt-3"> 
              <h6 class="font-weight-bold text-center text-<?=$color;?> pt-1"><?=$result;?></h6>           
            </div>

            <div class="col-8">
              <table class="table table-sm table-borderless">
                <tbody>
                  <tr>
                    <td class="text-<?= $color;?> pt-3"><?=$data['sha256'];?></td>
                  </tr>
                  <tr>
                    <td class="text-<?= $color;?>"><?=$data['names'][0];?></td>
                  </tr>
                  <tr>
                    <td class="text-<?= $color;?>"><?=$data['type_description'];?></td>
                  <tr>
                    <td class="text-<?= $color;?>"><?=formatBytes($data['size']);?></td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>

          <div class="card-header alert-<?=$color;?>" id="detection">
            <h5 class="font-weight-bold text-center">DETECTION</h5>
          </div>
          <table class="table table-sm">
            <thead>
              <tr>
                <th scope="col" colspan="2" class="bg-light">Status</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>Undetected</td>
                <td><?=$stats['undetected'];?></td>
              </tr>
              <tr>
                <td>Malicious</td>
                <td><?=$stats['malicious'];?></td>
              </tr>
              <tr>
                <td>Suspicous</td>
                <td><?=$stats['suspicious'];?></td>
              </tr>
              <tr>
                <td>Harmless</td>
                <td><?=$stats['harmless'];?></td>
              </tr>
              <tr>
                <td>Type Unsupported</td>
                <td><?=$stats['type-unsupported'];?></td>
              </tr>     
              <tr>
                <td>Failure</td>
                <td><?=$stats['failure'];?></td>
              </tr>
              <tr>
                <td>Timeout</td>
                <td><?=$stats['timeout'];?></td>
              </tr>

            </tbody>
          </table>

          <table class="table table-sm">
            <thead>
              <tr>
                <th scope="col" colspan="3" class="bg-light py-2">Analysis</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <?php if(isset($detec['ALYac'])):?>
                  <td>ALYac</td>
                  <td><?=$detec['ALYac']['category'];?></td>
                  <td class="text-danger"><?=$detec['ALYac']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['APEX'])):?>
                  <td>APEX</td>
                  <td><?=$detec['APEX']['category'];?></td>
                  <td class="text-danger"><?=$detec['APEX']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['AVG'])):?>
                  <td>AVG</td>
                  <td><?=$detec['AVG']['category'];?></td>
                  <td class="text-danger"><?=$detec['AVG']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['Acronis'])):?>
                  <td>Acronis</td>
                  <td><?=$detec['Acronis']['category'];?></td>
                  <td class="text-danger"><?=$detec['Acronis']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['Ad-Aware'])):?>
                  <td>Ad-Aware</td>
                  <td><?=$detec['Ad-Aware']['category'];?></td>
                  <td class="text-danger"><?=$detec['Ad-Aware']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['AegisLab'])):?>
                  <td>AegisLab</td>
                  <td><?=$detec['AegisLab']['category'];?></td>
                  <td class="text-danger"><?=$detec['AegisLab']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['AhnLab-V3'])):?>
                  <td>AhnLab-V3</td>
                  <td><?=$detec['AhnLab-V3']['category'];?></td>
                  <td class="text-danger"><?=$detec['AhnLab-V3']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['Alibaba'])):?>
                  <td>Alibaba</td>
                  <td><?=$detec['Alibaba']['category'];?></td>
                  <td class="text-danger"><?=$detec['Alibaba']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['Antiy-AVL'])):?>
                  <td>Antiy-AVL</td>
                  <td><?=$detec['Antiy-AVL']['category'];?></td>
                  <td class="text-danger"><?=$detec['Antiy-AVL']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['Arcabit'])):?>
                  <td>Arcabit</td>
                  <td><?=$detec['Arcabit']['category'];?></td>
                  <td class="text-danger"><?=$detec['Arcabit']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['Avast'])):?>
                  <td>Avast</td>
                  <td><?=$detec['Avast']['category'];?></td>
                  <td class="text-danger"><?=$detec['Avast']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['Avast-Mobile'])):?>
                  <td>Avast-Mobile</td>
                  <td><?=$detec['Avast-Mobile']['category'];?></td>
                  <td class="text-danger"><?=$detec['Avast-Mobile']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['Avira'])):?>
                  <td>Avira</td>
                  <td><?=$detec['Avira']['category'];?></td>
                  <td class="text-danger"><?=$detec['Avira']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['Baidu'])):?>
                  <td>Baidu</td>
                  <td><?=$detec['Baidu']['category'];?></td>
                  <td class="text-danger"><?=$detec['Baidu']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['BitDefender'])):?>
                  <td>BitDefender</td>
                  <td><?=$detec['BitDefender']['category'];?></td>
                  <td class="text-danger"><?=$detec['BitDefender']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['BitDefenderTheta'])):?>
                <td>BitDefenderTheta</td>
                <td><?=$detec['BitDefenderTheta']['category'];?></td>
                <td class="text-danger"><?=$detec['BitDefenderTheta']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['Bkav'])):?>
                <td>Bkav</td>
                <td><?=$detec['Bkav']['category'];?></td>
                <td class="text-danger"><?=$detec['Bkav']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['CAT-QuickHeal'])):?>
                <td>CAT-QuickHeal</td>
                <td><?=$detec['CAT-QuickHeal']['category'];?></td>
                <td class="text-danger"><?=$detec['CAT-QuickHeal']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['CMC'])):?>
                <td>CMC</td>
                <td><?=$detec['CMC']['category'];?></td>
                <td class="text-danger"><?=$detec['CMC']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['ClamAV'])):?>
                <td>ClamAV</td>
                <td><?=$detec['ClamAV']['category'];?></td>
                <td class="text-danger"><?=$detec['ClamAV']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['Comodo'])):?>
                <td>Comodo</td>
                <td><?=$detec['Comodo']['category'];?></td>
                <td class="text-danger"><?=$detec['Comodo']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['CrowdStrike'])):?>
                <td>CrowdStrike</td>
                <td><?=$detec['CrowdStrike']['category'];?></td>
                <td class="text-danger"><?=$detec['CrowdStrike']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['Cybereason'])):?>
                <td>Cybereason</td>
                <td><?=$detec['Cybereason']['category'];?></td>
                <td class="text-danger"><?=$detec['Cybereason']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['Cylance'])):?>
                <td>Cylance</td>
                <td><?=$detec['Cylance']['category'];?></td>
                <td class="text-danger"><?=$detec['Cylance']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['Cyren'])):?>
                <td>Cyren</td>
                <td><?=$detec['Cyren']['category'];?></td>
                <td class="text-danger"><?=$detec['Cyren']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['DrWeb'])):?>
                <td>DrWeb</td>
                <td><?=$detec['DrWeb']['category'];?></td>
                <td class="text-danger"><?=$detec['DrWeb']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['eGambit'])):?>
                <td>eGambit</td>
                <td><?=$detec['eGambit']['category'];?></td>
                <td class="text-danger"><?=$detec['eGambit']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['ESET-NOD32'])):?>
                <td>ESET-NOD32</td>
                <td><?=$detec['ESET-NOD32']['category'];?></td>
                <td class="text-danger"><?=$detec['ESET-NOD32']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['Emsisoft'])):?>
                <td>Emsisoft</td>
                <td><?=$detec['Emsisoft']['category'];?></td>
                <td class="text-danger"><?=$detec['Emsisoft']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['Endgame'])):?>
                <td>Endgame</td>
                <td><?=$detec['Endgame']['category'];?></td>
                <td class="text-danger"><?=$detec['Endgame']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['F-Prot'])):?>
                <td>F-Prot</td>
                <td><?=$detec['F-Prot']['category'];?></td>
                <td class="text-danger"><?=$detec['F-Prot']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['F-Secure'])):?>
                <td>F-Secure</td>
                <td><?=$detec['F-Secure']['category'];?></td>
                <td class="text-danger"><?=$detec['F-Secure']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['FireEye'])):?>
                <td>FireEye</td>
                <td><?=$detec['FireEye']['category'];?></td>
                <td class="text-danger"><?=$detec['FireEye']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['Fortinet'])):?>
                <td>Fortinet</td>
                <td><?=$detec['Fortinet']['category'];?></td>
                <td class="text-danger"><?=$detec['Fortinet']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['GData'])):?>
                <td>GData</td>
                <td><?=$detec['GData']['category'];?></td>
                <td class="text-danger"><?=$detec['GData']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['Ikarus'])):?>
                <td>Ikarus</td>
                <td><?=$detec['Ikarus']['category'];?></td>
                <td class="text-danger"><?=$detec['Ikarus']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['Invincea'])):?>
                <td>Invincea</td>
                <td><?=$detec['Invincea']['category'];?></td>
                <td class="text-danger"><?=$detec['Invincea']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['Jiangmin'])):?>
                  <td>Jiangmin</td>
                  <td><?=$detec['Jiangmin']['category'];?></td>
                  <td class="text-danger"><?=$detec['Jiangmin']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['K7AntiVirus'])):?>
                  <td>K7AntiVirus</td>
                  <td><?=$detec['K7AntiVirus']['category'];?></td>
                  <td class="text-danger"><?=$detec['K7AntiVirus']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['K7GW'])):?>
                  <td>K7GW</td>
                  <td><?=$detec['K7GW']['category'];?></td>
                  <td class="text-danger"><?=$detec['K7GW']['result'];?></td>
                <?php endif;?>
              </tr>                
              <tr>
                <?php if(isset($detec['Kaspersky'])):?>
                  <td>Kaspersky</td>
                  <td><?=$detec['Kaspersky']['category'];?></td>
                  <td class="text-danger"><?=$detec['Kaspersky']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['Kingsoft'])):?>
                  <td>Kingsoft</td>
                  <td><?=$detec['Kingsoft']['category'];?></td>
                  <td class="text-danger"><?=$detec['Kingsoft']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['MAX'])):?>
                  <td>MAX</td>
                  <td><?=$detec['MAX']['category'];?></td>
                  <td class="text-danger"><?=$detec['MAX']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['Malwarebytes'])):?>
                  <td>Malwarebytes</td>
                  <td><?=$detec['Malwarebytes']['category'];?></td>
                  <td class="text-danger"><?=$detec['Malwarebytes']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['McAfee'])):?>
                  <td>McAfee</td>
                  <td><?=$detec['McAfee']['category'];?></td>
                  <td class="text-danger"><?=$detec['McAfee']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['McAfee-GW-Edition'])):?>
                  <td>McAfee-GW-Edition</td>
                  <td><?=$detec['McAfee-GW-Edition']['category'];?></td>
                  <td class="text-danger"><?=$detec['McAfee-GW-Edition']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['MicroWorld-eScan'])):?>
                  <td>MicroWorld-eScan</td>
                  <td><?=$detec['MicroWorld-eScan']['category'];?></td>
                  <td class="text-danger"><?=$detec['MicroWorld-eScan']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['Microsoft'])):?>
                  <td>Microsoft</td>
                  <td><?=$detec['Microsoft']['category'];?></td>
                  <td class="text-danger"><?=$detec['Microsoft']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['NANO-Antivirus'])):?>
                  <td>NANO-Antivirus</td>
                  <td><?=$detec['NANO-Antivirus']['category'];?></td>
                  <td class="text-danger"><?=$detec['NANO-Antivirus']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['Paloalto'])):?>
                  <td>Paloalto</td>
                  <td><?=$detec['Paloalto']['category'];?></td>
                  <td class="text-danger"><?=$detec['Paloalto']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['Panda'])):?>
                  <td>Panda</td>
                  <td><?=$detec['Panda']['category'];?></td>
                  <td class="text-danger"><?=$detec['Panda']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
                <?php if(isset($detec['Qihoo-360'])):?>
                  <td>Qihoo-360</td>
                  <td><?=$detec['Qihoo-360']['category'];?></td>
                  <td class="text-danger"><?=$detec['Qihoo-360']['result'];?></td>
                <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['Rising'])):?>
                <td>Rising</td>
                <td><?=$detec['Rising']['category'];?></td>
                <td class="text-danger"><?=$detec['Rising']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['SUPERAntiSpyware'])):?>
                <td>SUPERAntiSpyware</td>
                <td><?=$detec['SUPERAntiSpyware']['category'];?></td>
                <td class="text-danger"><?=$detec['SUPERAntiSpyware']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['Sangfor'])):?>
                <td>Sangfor</td>
                <td><?=$detec['Sangfor']['category'];?></td>
                <td class="text-danger"><?=$detec['Sangfor']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['SentinelOne'])):?>
                <td>SentinelOne</td>
                <td><?=$detec['SentinelOne']['category'];?></td>
                <td class="text-danger"><?=$detec['SentinelOne']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['Sophos'])):?>
                <td>Sophos</td>
                <td><?=$detec['Sophos']['category'];?></td>
                <td class="text-danger"><?=$detec['Sophos']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['Symantec'])):?>
                <td>Symantec</td>
                <td><?=$detec['Symantec']['category'];?></td>
                <td class="text-danger"><?=$detec['Symantec']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['SymantecMobileInsight'])):?>
                <td>Symantec Mobile Insight</td>
                <td><?=$detec['SymantecMobileInsight']['category'];?></td>
                <td class="text-danger"><?=$detec['SymantecMobileInsight']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['TACHYON'])):?>
                <td>TACHYON</td>
                <td><?=$detec['TACHYON']['category'];?></td>
                <td class="text-danger"><?=$detec['TACHYON']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['Tencent'])):?>
                <td>Tencent</td>
                <td><?=$detec['Tencent']['category'];?></td>
                <td class="text-danger"><?=$detec['Tencent']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['Trapmine'])):?>
                <td>Trapmine</td>
                <td><?=$detec['Trapmine']['category'];?></td>
                <td class="text-danger"><?=$detec['Trapmine']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['TrendMicro'])):?>
                <td>TrendMicro</td>
                <td><?=$detec['TrendMicro']['category'];?></td>
                <td class="text-danger"><?=$detec['TrendMicro']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['TrendMicro-HouseCall'])):?>
                <td>TrendMicro-HouseCall</td>
                <td><?=$detec['TrendMicro-HouseCall']['category'];?></td>
                <td class="text-danger"><?=$detec['TrendMicro-HouseCall']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['VBA32'])):?>
                <td>VBA32</td>
                <td><?=$detec['VBA32']['category'];?></td>
                <td class="text-danger"><?=$detec['VBA32']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['VIPRE'])):?>
                <td>VIPRE</td>
                <td><?=$detec['VIPRE']['category'];?></td>
                <td class="text-danger"><?=$detec['VIPRE']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['ViRobot'])):?>
                <td>ViRobot</td>
                <td><?=$detec['ViRobot']['category'];?></td>
                <td class="text-danger"><?=$detec['ViRobot']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['Webroot'])):?>
                <td>Webroot</td>
                <td><?=$detec['Webroot']['category'];?></td>
                <td class="text-danger"><?=$detec['Webroot']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['Yandex'])):?>
                <td>Yandex</td>
                <td><?=$detec['Yandex']['category'];?></td>
                <td class="text-danger"><?=$detec['Yandex']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['Zillya'])):?>
                <td>Zillya</td>
                <td><?=$detec['Zillya']['category'];?></td>
                <td class="text-danger"><?=$detec['Zillya']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['ZoneAlarm'])):?>
                <td>ZoneAlarm</td>
                <td><?=$detec['ZoneAlarm']['category'];?></td>
                <td class="text-danger"><?=$detec['ZoneAlarm']['result'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($detec['Zoner'])):?>
                <td>Zoner</td>
                <td><?=$detec['Zoner']['category'];?></td>
                <td class="text-danger"><?=$detec['Zoner']['result'];?></td>
              <?php endif;?>
              </tr>
            </tbody>
          </table>

          <br>
          <div class="card-header alert-<?=$color;?>" id="details">
            <h5 class="font-weight-bold text-center">DETAILS</h5>
          </div>

          <table class="table table-sm">
            <thead>
              <tr>
                <th scope="col" colspan="2" class="bg-light">Basic Properties</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>MD5</td>
                <td><?=$data['md5'];?></td>
              </tr>
              <tr>
                <td>SHA-1</td>
                <td><?=$data['sha1'];?></td>
              </tr>
              <tr>
                <td>SHA-256</td>
                <td><?=$data['sha256'];?></td>
              </tr>
              <tr>
                <td>Vhash</td>
                <td><?=$data['vhash'];?></td>
              </tr>
              <tr>
                <td>SSDEEP</td>
                <td><?=$data['ssdeep'];?></td>
              </tr>
              <tr>
                <td>File Type</td>
                <td><?=$data['type_description'];?></td>
              </tr>
              <tr>
                <td>Magic</td>
                <td><?=$data['magic'];?></td>
              </tr>
              <tr>
                <td>File Size</td>
                <td><?=formatBytes($data['size']);?></td>
              </tr>
            </tbody>
          </table>

          <table class="table table-sm">
            <thead>
              <tr>
                <th scope="col" colspan="2" class="bg-light">History</th>
              </tr>
            </thead>
            <tbody>

              <tr>
              <?php if(isset($data['creation_date'])):?>
                <td>Creation Time</td>
                <td><?= date("Y-m-d h:i:s", $data['creation_date']);?></td>
              <?php endif; ?>
              </tr>

              <tr>
              <?php if(isset($data['last_modification_date'])):?>
                <td>Creation Time</td>
                <td><?= date("Y-m-d h:i:s", $data['last_modification_date']);?></td>
              <?php endif; ?>
              </tr>

              <tr>
              <?php if(isset($data['first_submission_date'])):?>
                <td>First Submission</td>
                <td><?= date("Y-m-d h:i:s", $data['first_submission_date']);?></td>
              <?php endif; ?>
              </tr>

              <tr>
              <?php if(isset($data['last_submission_date'])):?>
                <td>Last Submission</td>
                <td><?= date("Y-m-d h:i:s", $data['last_submission_date']);?></td>
              <?php endif; ?>
              </tr>

              <tr>
              <?php if(isset($data['last_analysis_date'])):?>
                <td>Last Analysis</td>
                <td><?= date("Y-m-d h:i:s", $data['last_analysis_date']);?></td>
              <?php endif; ?>
              </tr>

            </tbody>
          </table>

          <table class="table table-sm">
            <thead>
              <tr>
                <th scope="col" colspan="2" class="bg-light">Names</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="2"><?=$data['names'][0];?></td>
              </tr>
            </tbody>
          </table>

          <table class="table table-sm">
            <thead>
              <tr>
                <th scope="col" colspan="2" class="bg-light">ExifTool File Metadata</th>
              </tr>
            </thead>
            <tbody>

              <!-- BASIC -->
              <tr>
              <?php if(isset($exif['FileType'])):?>
                <td>FileType</td>
                <td><?=$exif['FileType'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['FileTypeExtension'])):?>
                <td>FileTypeExtension</td>
                <td><?=$exif['FileTypeExtension'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['MIMEType'])):?>
                <td>MIMEType</td>
                <td><?=$exif['MIMEType'];?></td>
              <?php endif;?>
              </tr>

              <!-- XLS-XLSX | DOC-DOCX | PPT-PPTX -->
              <tr>
              <?php if(isset($exif['AppVersion'])):?>
                <td>AppVersion</td>
                <td><?=$exif['AppVersion'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['Application'])):?>
                <td>Application</td>
                <td><?=$exif['Application'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['Characters'])):?>
                <td>Characters</td>
                <td><?=$exif['Characters'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['Company'])):?>
                <td>Company</td>
                <td><?=$exif['Company'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['CharactersWithSpaces'])):?>
                <td>CharactersWithSpaces</td>
                <td><?=$exif['CharactersWithSpaces'];?></td>
              <?php endif;?>
              </tr>
              <?php if(isset($exif['CreateDate'])):?>
                <td>CreateDate</td>
                <td><?=$exif['CreateDate'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['HiddenSlides'])):?>
                <td>HiddenSlides</td>
                <td><?=$exif['HiddenSlides'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['DocSecurity'])):?>
                <td>DocSecurity</td>
                <td><?=$exif['DocSecurity'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['HyperlinksChanged'])):?>
                <td>HyperlinksChanged</td>
                <td><?=$exif['HyperlinksChanged'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['MMClips'])):?>
                <td>MMClips</td>
                <td><?=$exif['MMClips'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['LastPrinted'])):?>
                <td>LastPrinted</td>
                <td><?=$exif['LastPrinted'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['Lines'])):?>
                <td>Lines</td>
                <td><?=$exif['Lines'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['LinksUpToDate'])):?>
                <td>LinksUpToDate</td>
                <td><?=$exif['LinksUpToDate'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['ModifyDate'])):?>
                <td>ModifyDate</td>
                <td><?=$exif['ModifyDate'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['Pages'])):?>
                <td>Pages</td>
                <td><?=$exif['Pages'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['Notes'])):?>
                <td>Notes</td>
                <td><?=$exif['Notes'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['Paragraphs'])):?>
                <td>Paragraphs</td>
                <td><?=$exif['Paragraphs'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['PresentationFormat'])):?>
                <td>PresentationFormat</td>
                <td><?=$exif['PresentationFormat'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['PreviewImage'])):?>
                <td>PreviewImage</td>
                <td><?=$exif['PreviewImage'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['RevisionNumber'])):?>
                <td>RevisionNumber</td>
                <td><?=$exif['RevisionNumber'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['ScaleCrop'])):?>
                <td>ScaleCrop</td>
                <td><?=$exif['ScaleCrop'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['ShareDoc'])):?>
                <td>ShareDoc</td>
                <td><?=$exif['ShareDoc'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['Slides'])):?>
                <td>Slides</td>
                <td><?=$exif['Slides'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['Template'])):?>
                <td>Template</td>
                <td><?=$exif['Template'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['TotalEditTime'])):?>
                <td>TotalEditTime</td>
                <td><?=$exif['TotalEditTime'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['Words'])):?>
                <td>Words</td>
                <td><?=$exif['Words'];?></td>
              <?php endif;?>
              </tr>

              <!-- PDF -->
              <tr>
              <?php if(isset($exif['Linearized'])):?>
                <td>Linearized</td>
                <td><?=$exif['Linearized'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['PDFVersion'])):?>
                <td>PDFVersion</td>
                <td><?=$exif['PDFVersion'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['PageCount'])):?>
                <td>PageCount</td>
                <td><?=$exif['PageCount'];?></td>
              <?php endif;?>
              </tr>

              <!-- TXT -->
              <tr>
              <?php if(isset($exif['LineCount'])):?>
                <td>LineCount</td>
                <td><?=$exif['LineCount'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['MIMEEncoding'])):?>
                <td>MIMEEncoding</td>
                <td><?=$exif['MIMEEncoding'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['NewLines'])):?>
                <td>NewLines</td>
                <td><?=$exif['NewLines'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['WordCount'])):?>
                <td>WordCount</td>
                <td><?=$exif['WordCount'];?></td>
              <?php endif;?>
              </tr>

              <!-- ZIP -->
              <tr>
              <?php if(isset($exif['ZipBitFlag'])):?>
                <td>ZipBitFlag</td>
                <td><?=$exif['ZipBitFlag'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['ZipCRC'])):?>
                <td>ZipCRC</td>
                <td><?=$exif['ZipCRC'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['ZipCompressedSize'])):?>
                <td>ZipCompressedSize</td>
                <td><?=$exif['ZipCompressedSize'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['ZipCompression'])):?>
                <td>ZipCompression</td>
                <td><?=$exif['ZipCompression'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['ZipFileName'])):?>
                <td>ZipFileName</td>
                <td><?=$exif['ZipFileName'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['ZipModifyDate'])):?>
                <td>ZipModifyDate</td>
                <td><?=$exif['ZipModifyDate'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['ZipRequiredVersion'])):?>
                <td>ZipRequiredVersion</td>
                <td><?=$exif['ZipRequiredVersion'];?></td>
              <?php endif;?>
              </tr>
              <tr>
              <?php if(isset($exif['ZipUncompressedSize'])):?>
                <td>ZipUncompressedSize</td>
                <td><?=$exif['ZipUncompressedSize'];?></td>
              <?php endif;?>
              </tr>

            </tbody>
          </table>
        </div>
      </div>

      <div class="row justify-content-center">
        <div class="col-sm-1 text-center mb-4 mt-2">
          <a href="m.deteksi.php?idm=<?=$idm;?>" class="btn btn-block btn-secondary">OK</a>
        </div>
      </div>
    </div>
    </section>
    <!-- hasil analisa Virus Total -->

    <!-- footer -->
    <footer class="bg-dark text-white">
      <div class="row pt-3">
        <div class="col text-center">
          <p>&copy; Copyright 2020 | by Rela Annisa Camilia.</p>
        </div>
      </div>
    </footer>
    <!-- akhir footer -->
    
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script type="text/javascript" src="../../js/jquery-3.4.1.min.js"></script>
    <script type="text/javascript" src="../../js/popper.min.js"></script>
    <script type="text/javascript" src="../../js/bootstrap.min.js"></script>
  </body>
</html>