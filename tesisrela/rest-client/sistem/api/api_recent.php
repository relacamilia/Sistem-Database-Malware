<?php

require '../../guzzle/vendor/autoload.php';
use GuzzleHttp\Client;

$client = new Client([
    'base_uri' => 'http://localhost/tesisrela/rest-server/api/'
]);


//------------------------- RECENT | ADMIN ---------------------------------
function getAllRecent(){

    global $client;    
    $response = $client->request('GET', "recent", []);
    $result = json_decode($response->getBody()->getContents(),true);
    return $result['data'];

}


function createRecent($dataRec){

    global $client;

    $data = [

        'waktu_input' => date("d-m-Y"),  
        'file' => $dataRec["file"],
        'sha256' => $dataRec["sha256"],
        'status' => $dataRec["status"],
        'aksi' => $dataRec["aksi"],
        'oleh' => $dataRec["oleh"]

    ];

    $response = $client->request('POST', 'recent', [
        'form_params' => $data
    ]);

    $result = json_decode($response->getBody()->getContents(),true);
    return $result;

}


//---------------------------- MRIWAYAT | MITRA ---------------------------
function getMRiwayat($idm){

    global $client;    
    $response = $client->request('GET', "m_riwayat", [
        'query' => ['idm' => $idm]
    ]);
    $result = json_decode($response->getBody()->getContents(),true);
    return $result['data'];

}


function createMRiwayat($data){

    global $client;

    $data = [

        'idm' => $data["idm"],
        'waktu_input' => date("d-m-Y"),  
        'file_mitra' => $data["file_mitra"],
        'sha256_mitra' => $data["sha256_mitra"],
        'status' => $data["status"],
        'aksi' => $data["aksi"],
        'metode' => $data["metode"]

    ];

    $response = $client->request('POST', 'm_riwayat', [
        'form_params' => $data
    ]);

    $result = json_decode($response->getBody()->getContents(),true);
    return $result;

}


//------------------------- RIWAYAT | USER ---------------------------
function getRiwayat(){

    global $client;    
    $response = $client->request('GET', "riwayat", []);
    $result = json_decode($response->getBody()->getContents(),true);
    return $result['data'];

}


function createRiwayat($data){

    global $client;

    $data = [
        'waktu_input' => date("d-m-Y"),  
        'file_user' => $data["file_user"],
        'sha256_user' => $data["sha256_user"],
        'status' => $data["status"],
        'metode' => $data["metode"]
    ];

    $response = $client->request('POST', 'riwayat', [
        'form_params' => $data
    ]);

    $result = json_decode($response->getBody()->getContents(),true);
    return $result;

}
?>