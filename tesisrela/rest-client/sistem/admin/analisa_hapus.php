<?php 
session_start();
if( !isset($_SESSION["login"])){
	header("Location: login.php");
	exit;
}

//--------------------------RESTFULL----------------------------
require '../api/api_baru.php';
require '../api/api_recent.php';
require '../api/api_admin.php';

$id = $_GET["id"];
$ida = $_GET["ida"];

$admin = getAdminById($ida);
$baru = getBaruById($id);
$dataRec = [
	'file' => $baru["file_baru"],
	'sha256' => $baru["sha256_baru"],
	'status' => "File Baru",
	'aksi' => "Dihapus",
	'oleh' => $admin["username"]
];

if( deleteBaru($id)>0) {

	//input ke recent
    if( createRecent($dataRec) === 0){
        echo "<script>
            alert('Data Gagal ditambahkan ke recent!');
            document.location.href = 'analisa.php?ida=$ida';
            </script>";
	}

//kalau berhasil	
echo "<script>
      alert('Data BERHASIL Dihapus!');
	  document.location.href = 'analisa.php?ida=$ida';
	  </script>";

//kalau gagal
} else {
	echo "<script>
		  alert('Data GAGAL Dihapus!');
		  document.location.href = 'analisa.php?ida=$ida';
		  </script>";
}

?>