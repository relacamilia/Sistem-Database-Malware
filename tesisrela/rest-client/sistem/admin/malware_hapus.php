<?php 
session_start();
if( !isset($_SESSION["login"])){
	header("Location: login.php");
	exit;
}

//-------------------------RESTFULL---------------------------
require '../api/api_malware.php';
require '../api/api_recent.php';
require '../api/api_admin.php';

$ida = $_GET['ida'];
$admin = getAdminById($ida);

$id = $_GET["id"];
$mal = getMalwareById($id);
$dataRec = [
	'file' => $mal["file_malware"],
	'sha256' => $mal["sha256_malware"],
	'status' => "Malware",
	'aksi' => "Dihapus",
	'oleh' => $admin["username"]
];

if( deleteMalware($id)>0) {

	//input ke recent
    if( createRecent($dataRec) === 0){
        echo "<script>
            alert('Data Gagal ditambahkan ke recent!');
            document.location.href = 'malware.php?ida=$ida';
            </script>";
	}

//kalau berhasil	
echo "<script>
      alert('Data BERHASIL Dihapus!');
	  document.location.href = 'malware.php?ida=$ida';
	  </script>";

//kalau gagal
} else {
	echo "<script>
		  alert('Data GAGAL Dihapus!');
		  document.location.href = 'malware.php?ida=$ida';
		  </script>";
}

?>