<?php
use Restserver\Libraries\REST_Controller;
defined('BASEPATH') or exit ('No direct script access allowed');

require APPPATH . 'libraries/REST_Controller.php';
require APPPATH . 'libraries/Format.php';


class m_Riwayat extends REST_Controller
{
    public function __construct()
    {
        parent::__construct();
        $this->load->model('m_Riwayat_model', 'm_riwayat');
    }

//Menampilkan/ mengambil data 
    public function index_get()
    {
        $idm = $this->get('idm');
        $m_riwayat = $this->m_riwayat->getMRiwayat($idm);
         
        if($m_riwayat)
        {
            $this->response([
                'status' => 1,
                'data' => $m_riwayat
            ], REST_Controller::HTTP_OK); 
        } else {
            $this->response([
                'status' => 0,
                'message' => 'id m_riwayat tidak ditemukan'
            ]); 
        }
    }


//Tambah data 
    public function index_post()
    {
        $data = [
            'idm' => $this->post('idm'),
            'waktu_input' => $this->post('waktu_input'),
            'file_mitra' => $this->post('file_mitra'),
            'sha256_mitra' => $this->post('sha256_mitra'),
            'status' => $this->post('status'),
            'aksi' => $this->post('aksi'),
            'metode' => $this->post('metode')
        ];
        
        if( $this->m_riwayat->createMRiwayat($data) > 0){
            $this->response([
                'status' => 1,
                'message' => 'file baru berhasil ditambahkan'
            ], REST_Controller::HTTP_CREATED); 
        } else {
            $this->response([
                'status' => 0,
                'message' => 'gagal menambahkan data'
            ]);
        }
    }

}

?>