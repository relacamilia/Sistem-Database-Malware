<?php
use Restserver\Libraries\REST_Controller;
defined('BASEPATH') or exit ('No direct script access allowed');

require APPPATH . 'libraries/REST_Controller.php';
require APPPATH . 'libraries/Format.php';


class Riwayat extends REST_Controller
{
    public function __construct()
    {
        parent::__construct();
        $this->load->model('Riwayat_model', 'riwayat');
    }

//Menampilkan/ mengambil data 
    public function index_get()
    {
        $riwayat = $this->riwayat->getRiwayat(); 
        
        if($riwayat)
        {
            $this->response([
                'status' => 1,
                'data' => $riwayat
            ], REST_Controller::HTTP_OK); 
        } else {
            $this->response([
                'status' => 0,
                'message' => 'Gagal menampilkan riwayat!'
            ]); 
        }
    }


//Tambah data 
    public function index_post()
    {
        $data = [
            'waktu_input' => $this->post('waktu_input'),
            'file_user' => $this->post('file_user'),
            'sha256_user' => $this->post('sha256_user'),
            'status' => $this->post('status'),
            'metode' => $this->post('metode')
        ];
        
        if( $this->riwayat->createRiwayat($data) > 0){
            $this->response([
                'status' => 1,
                'message' => 'File baru berhasil ditambahkan!'
            ], REST_Controller::HTTP_CREATED); 
        } else {
            $this->response([
                'status' => 0,
                'message' => 'Gagal menambahkan data!'
            ]);
        }
    }
}

?>